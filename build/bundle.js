/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={"./src/Strategies.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n//策略对象 --主要的校验算法返回错误信息\r\nconst Strategies = {\r\n  //判断是否可为空\r\n  require: function (value, flay, errorMsg) {\r\n    if (flay) {\r\n      if (value === "" || value.length > 0) {\r\n        return errorMsg;\r\n      }\r\n    }\r\n  },\r\n  //判断类型\r\n  type: function (value, flay, errorMsg) {\r\n    let msg;\r\n    switch (flay) {\r\n      case "string":\r\n        msg = typeof value != "string" ? errorMsg : undefined;\r\n        break;\r\n      case "number":\r\n        msg = typeof value != "number" ? errorMsg : undefined;\r\n        break;\r\n      case "Array":\r\n        msg = !Array.isArray(value) ? errorMsg : undefined;\r\n        break;\r\n      case "object":\r\n        msg = value.constructor != Object ? errorMsg : undefined;\r\n        break;\r\n      case "email":\r\n        msg = Strategies["pattern"](\r\n          value,\r\n          /^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/,\r\n          errorMsg\r\n        );\r\n        break;\r\n      case "phone":\r\n        msg = Strategies["pattern"](\r\n          value,\r\n          /^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d{8}$/,\r\n          errorMsg\r\n        );\r\n        break;\r\n      default:\r\n        (msg = "暂无此类型"), console.error("没有该类型的参数");\r\n        break;\r\n    }\r\n\r\n    return msg;\r\n  },\r\n  //判断长度\r\n  min: function (value, flay, errorMsg) {\r\n    if (typeof value === "number" || Array.isArray(value)) {\r\n      if (value < flay) {\r\n        return errorMsg;\r\n      }\r\n    } else if (typeof value === "string") {\r\n      if (value.length < flay) {\r\n        return errorMsg;\r\n      }\r\n    }\r\n  },\r\n  //判断长度\r\n  max: function (value, flay, errorMsg) {\r\n    if (typeof value === "number" || Array.isArray(value)) {\r\n      if (value > flay) {\r\n        return errorMsg;\r\n      }\r\n    } else if (typeof value === "string") {\r\n      if (value.length > flay) {\r\n        return errorMsg;\r\n      }\r\n    }\r\n  },\r\n  //判断正则\r\n  pattern: function (value, reg, errorMsg) {\r\n    if (!reg.test(value)) {\r\n      return errorMsg;\r\n    }\r\n  },\r\n  //值索引\r\n  key: (value, key, errorMsg, data) => {\r\n    if (value !== data[key]) {\r\n      return errorMsg;\r\n    }\r\n  },\r\n};\r\n//\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Strategies);\r\n\n\n//# sourceURL=webpack://validattoy/./src/Strategies.js?')},"./src/errorMsg.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n//默认信息提示\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\r\n  require: "该数值不能为空",\r\n  type: "该数值类型不符合要求",\r\n  min: "长度过短或数值过小",\r\n  max: "长度过长或数值过大",\r\n  pattern: "正则校验失败",\r\n  validator: "自定义校验失败",\r\n  key: "该值不等于指向的值",\r\n});\r\n\n\n//# sourceURL=webpack://validattoy/./src/errorMsg.js?')},"./src/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (/* binding */ Validators)\n/* harmony export */ });\n/* harmony import */ var _Strategies_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Strategies.js */ "./src/Strategies.js");\n/* harmony import */ var _errorMsg_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./errorMsg.js */ "./src/errorMsg.js");\n\r\n\r\nclass Validators {\r\n  constructor(data = this.isNotEmpty(), rules = this.isNotEmpty()) {\r\n    //记录数值\r\n    this.data = data;\r\n    //记录指令\r\n    this.rules = rules;\r\n    this.errMsg = {};\r\n    this.init();\r\n  }\r\n  init() {\r\n    //初始化\r\n    for (let key in this.rules) {\r\n      //判断值是否对应data中的值\r\n      if (this.data.hasOwnProperty(key)) {\r\n        this.volid(key, this.data[key], this.rules[key]);\r\n      } else {\r\n        throw new Error("没有对应的数据");\r\n      }\r\n    }\r\n  }\r\n  //检验\r\n  volid(key, value, rules) {\r\n    //记录错误\r\n    this.errMsg[key] = [];\r\n    rules.forEach((item) => {\r\n      //检测自定义检验\r\n      if (item.validator) {\r\n        //收集callback回调\r\n        item.validator(value, this.callback.bind(this));\r\n      } else {\r\n        //收集错误信息\r\n        let msg = item.msg;\r\n        delete item.msg;\r\n        //获取所有策略\r\n        let arr = Object.keys(item);\r\n        //获取所有指令\r\n        let ag;\r\n        arr.forEach((val) => {\r\n          //默认错误信息插入\r\n          msg = msg && msg !== ag ? msg : _errorMsg_js__WEBPACK_IMPORTED_MODULE_1__["default"][val];\r\n          ag = msg;\r\n          //策略模式分发指令记录错误信息\r\n          this.errMsg[key].push(\r\n            _Strategies_js__WEBPACK_IMPORTED_MODULE_0__["default"][val](value, item[val], msg, this.data)\r\n          );\r\n        });\r\n      }\r\n    });\r\n  }\r\n  //校验\r\n  valid() {\r\n    //检测错误信息\r\n    for (let key in this.errMsg) {\r\n      //筛选空值\r\n      this.errMsg[key] = this.errMsg[key].filter(Boolean);\r\n      let arr = this.errMsg[key];\r\n      for (let k = 0; k < arr.length; k++) {\r\n        //输出错误信息\r\n        console.error(key + ":" + arr[k]);\r\n        //校验失败\r\n        return false;\r\n      }\r\n    }\r\n    //校验成功\r\n    return true;\r\n  }\r\n  //获取自定义校验回调\r\n  callback(err) {\r\n    err ? (this.errMsg["valider"] = [err]) : "";\r\n  }\r\n  //参数不能为空\r\n  isNotEmpty() {\r\n    throw new Error("缺少参数");\r\n  }\r\n  //用户可以定制自己的错误信息提示\r\n  static replaceMessage(options) {\r\n    for (let key in options) {\r\n      _errorMsg_js__WEBPACK_IMPORTED_MODULE_1__["default"][key] = options[key];\r\n    }\r\n  }\r\n}\r\n\n\n//# sourceURL=webpack://validattoy/./src/index.js?')}},__webpack_module_cache__={};function __webpack_require__(r){var e=__webpack_module_cache__[r];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(r,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),__webpack_require__.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/index.js")})();